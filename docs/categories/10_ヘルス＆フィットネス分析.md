# ヘルス&フィットネスアプリ分析

**調査日**: 2025年12月25日
**対象**: 38件のネイティブヘルス/フィットネスアプリ

---

## トップアプリ

| スター | アプリ | カテゴリ | 説明 |
|--------|--------|----------|------|
| 1,548 | Corona Tracker | ヘルス | COVID追跡 |
| 819 | OutRun | フィットネス | 屋外運動追跡 |
| 616 | RaceMe | フィットネス | ランニング&ゴースト |
| 375 | Corona Virus Tracker | ヘルス | SwiftUI製 |
| 274 | COVIDSafe | 接触追跡 | 豪州政府 |
| 268 | Nightguard | ヘルス | 血糖値監視 |
| 183 | Good Spirits | ヘルス | 飲酒追跡 |
| 179 | Go Cycling | フィットネス | サイクリング |
| 118 | Das E-Rezept | ヘルス | 電子処方箋 |
| 117 | HealthKit~Swift | サンプル | HealthKit例 |

---

## カテゴリ別詳細

### フィットネス追跡

| アプリ | スター | 機能 |
|--------|--------|------|
| OutRun | 819 | ウォーキング、ハイキング、サイクリング、スケート |
| RaceMe | 616 | ゴースト機能付きランニング |
| Go Cycling | 179 | サイクリング特化、SwiftUI |
| Gym Routine Tracker | 51 | ワークアウト記録、watchOS |
| RaceRunner | 87 | レース向けランニング |
| rTracker | 46 | 汎用データトラッカー |

### 健康管理

| アプリ | スター | 機能 |
|--------|--------|------|
| Nightguard | 268 | Nightscout血糖値表示 |
| Good Spirits | 183 | 飲酒量追跡、HealthKit連携 |
| Glucosio | 58 | 糖尿病管理 |
| MoodSnap | 58 | 気分日記、SwiftUI |
| MyWeight History | 81 | 体重記録、watchOS |
| Depressed | 99 | うつ病セルフチェック |
| Solstice | 97 | 日光時間追跡 |
| Rise | 44 | 睡眠スケジュール |

### 接触追跡（COVID関連）

| アプリ | スター | 国 |
|--------|--------|------|
| COVIDSafe | 274 | オーストラリア |
| Stopp Corona | 158 | オーストリア |
| SwissCovid | 144 | スイス |
| RadarCOVID | 143 | スペイン |
| ProteGO Safe | 90 | ポーランド |

### ResearchKit

| アプリ | スター | 用途 |
|--------|--------|------|
| MyHeartCounts | 67 | 心臓研究 |

---

## HealthKit統合パターン

### 権限リクエスト

```swift
import HealthKit

let healthStore = HKHealthStore()

func requestAuthorization() async throws {
    let typesToRead: Set<HKObjectType> = [
        HKQuantityType(.stepCount),
        HKQuantityType(.heartRate),
        HKQuantityType(.activeEnergyBurned)
    ]

    let typesToShare: Set<HKSampleType> = [
        HKQuantityType(.bodyMass),
        HKQuantityType(.workoutRoute)
    ]

    try await healthStore.requestAuthorization(
        toShare: typesToShare,
        read: typesToRead
    )
}
```

### データ読み取り

```swift
func fetchStepCount(for date: Date) async throws -> Double {
    let stepType = HKQuantityType(.stepCount)
    let predicate = HKQuery.predicateForSamples(
        withStart: date.startOfDay,
        end: date.endOfDay
    )

    let statistics = try await withCheckedThrowingContinuation {
        (continuation: CheckedContinuation<HKStatistics, Error>) in
        let query = HKStatisticsQuery(
            quantityType: stepType,
            quantitySamplePredicate: predicate,
            options: .cumulativeSum
        ) { _, statistics, error in
            if let error = error {
                continuation.resume(throwing: error)
            } else if let statistics = statistics {
                continuation.resume(returning: statistics)
            }
        }
        healthStore.execute(query)
    }

    return statistics.sumQuantity()?.doubleValue(for: .count()) ?? 0
}
```

### データ書き込み

```swift
func saveWorkout(
    type: HKWorkoutActivityType,
    start: Date,
    end: Date,
    calories: Double
) async throws {
    let workout = HKWorkout(
        activityType: type,
        start: start,
        end: end,
        duration: end.timeIntervalSince(start),
        totalEnergyBurned: HKQuantity(unit: .kilocalorie(), doubleValue: calories),
        totalDistance: nil,
        metadata: nil
    )

    try await healthStore.save(workout)
}
```

---

## 位置情報追跡パターン

### ワークアウトルート

```swift
import CoreLocation

class LocationTracker: NSObject, CLLocationManagerDelegate {
    let locationManager = CLLocationManager()
    var locations: [CLLocation] = []

    func startTracking() {
        locationManager.delegate = self
        locationManager.desiredAccuracy = kCLLocationAccuracyBest
        locationManager.allowsBackgroundLocationUpdates = true
        locationManager.startUpdatingLocation()
    }

    func locationManager(
        _ manager: CLLocationManager,
        didUpdateLocations locations: [CLLocation]
    ) {
        self.locations.append(contentsOf: locations)
    }
}
```

---

## UI/UXパターン

### ダッシュボード

**共通要素**:
- 今日の活動サマリー
- 週間/月間グラフ
- 目標進捗リング
- 最近のワークアウト

### ワークアウト記録

**要素**:
- 開始/停止ボタン
- リアルタイムメトリクス
- マップ表示
- ラップ/スプリット

### データ可視化

```swift
// Swift Charts使用例
Chart(weeklyData) { day in
    BarMark(
        x: .value("曜日", day.date, unit: .day),
        y: .value("歩数", day.steps)
    )
    .foregroundStyle(.blue.gradient)
}
.chartXAxis {
    AxisMarks(values: .stride(by: .day)) { _ in
        AxisValueLabel(format: .dateTime.weekday(.abbreviated))
    }
}
```

---

## watchOS連携

### ワークアウトセッション

```swift
import HealthKit
import WatchKit

class WorkoutManager: NSObject, HKWorkoutSessionDelegate {
    var session: HKWorkoutSession?
    var builder: HKLiveWorkoutBuilder?

    func startWorkout(type: HKWorkoutActivityType) async throws {
        let configuration = HKWorkoutConfiguration()
        configuration.activityType = type
        configuration.locationType = .outdoor

        session = try HKWorkoutSession(
            healthStore: healthStore,
            configuration: configuration
        )
        builder = session?.associatedWorkoutBuilder()

        session?.delegate = self
        builder?.dataSource = HKLiveWorkoutDataSource(
            healthStore: healthStore,
            workoutConfiguration: configuration
        )

        let startDate = Date()
        session?.startActivity(with: startDate)
        try await builder?.beginCollection(at: startDate)
    }
}
```

---

## Swiftパッケージ機会

### HealthKitSwiftUI

**機能**:
- Property wrapperでデータ取得
- SwiftUI対応グラフ
- 権限管理簡略化
- 単位変換

**API例**:
```swift
@HealthData(.stepCount, period: .today)
var todaySteps: Int?

@HealthData(.heartRate, period: .lastHour)
var recentHeartRates: [Double]

HealthRingView(
    current: todaySteps ?? 0,
    goal: 10000
)
```

### WorkoutKit

**機能**:
- ワークアウトセッション管理
- ルート記録
- 統計計算
- watchOS連携

### FitnessCharts

**機能**:
- 活動リング
- 週間/月間グラフ
- 比較チャート
- アニメーション

---

## 学習リソース

| アプリ | 学習ポイント |
|--------|-------------|
| OutRun | 完全なフィットネス追跡 |
| Nightguard | 外部サービス連携 |
| Go Cycling | SwiftUI + HealthKit |
| HealthKit~Swift | 基本的なHealthKit使用 |
| Gym Routine Tracker | watchOS連携 |

---

## 開発上の考慮事項

### プライバシー

| 項目 | 対応 |
|------|------|
| 権限説明 | Info.plistに詳細記載 |
| 最小権限 | 必要なデータのみ要求 |
| データ保護 | ローカル暗号化 |
| 同意取得 | 明確なUI |

### バックグラウンド処理

| 機能 | 設定 |
|------|------|
| 位置情報 | Background Modes有効化 |
| HealthKit | Background Delivery |
| 通知 | 目標達成時など |

### watchOS統合

| 考慮点 | 対応 |
|--------|------|
| 同期 | WatchConnectivity |
| 独立動作 | watchOS単体機能 |
| バッテリー | 効率的なセンサー使用 |

---

## トレンド

### 成長中
- SwiftUI + HealthKit統合
- watchOS独立アプリ
- メンタルヘルス

### 安定
- ランニング/サイクリング追跡
- 体重管理
- 睡眠追跡

### 注目
- Apple Watchセンサー新機能
- visionOS健康アプリ
- AI健康アドバイス
