# 金融&暗号通貨アプリ分析

**調査日**: 2025年12月25日
**対象**: 22件のネイティブ金融/暗号通貨アプリ

---

## トップアプリ

| スター | アプリ | カテゴリ | 説明 |
|--------|--------|----------|------|
| 1,276 | Dime | 家計簿 | Apple HIG準拠、SwiftUI |
| 841 | Unstoppable Wallet | 暗号 | 分散型ウォレット |
| 639 | Bread | 暗号 | Bitcoinウォレット |
| 624 | AlphaWallet | 暗号 | Ethereumウォレット |
| 281 | Wei Wallet | 暗号 | Ethereumウォレット |
| 273 | Bither | 暗号 | セキュアBitcoinウォレット |
| 213 | Spend Stack | 家計簿 | 予算追跡 |
| 150 | lil wallet | 暗号 | SwiftUI Ethereumウォレット |
| 118 | Expense Tracker | 家計簿 | 日常支出追跡 |

---

## カテゴリ別詳細

### 家計簿・予算管理

| アプリ | スター | 特徴 | 技術 |
|--------|--------|------|------|
| Dime | 1,276 | Appleガイドライン準拠 | SwiftUI |
| Spend Stack | 213 | 予算追跡 | Swift |
| Expense Tracker | 118 | シンプル | Swift |
| Smart Wallet | 52 | マネー管理 | Swift |
| My Assets | 19 | 資産概要 | SwiftUI |
| MoneyPlus | 40 | 収支記録 | Swift |
| MoneyMate | 35 | 収支記録 | Swift |

### 暗号通貨ウォレット

| アプリ | スター | 対応通貨 | 特徴 |
|--------|--------|----------|------|
| Unstoppable | 841 | BTC, ETH, EOS等 | 分散型 |
| Bread | 639 | Bitcoin | シンプル |
| AlphaWallet | 624 | Ethereum | NFT対応 |
| Wei Wallet | 281 | Ethereum | 使いやすい |
| Bither | 273 | Bitcoin | セキュア、watchOS |
| lil wallet | 150 | Ethereum | SwiftUI製 |
| Fearless | 91 | Kusama, Polkadot | Substrate |
| Essentia | 61 | マルチ | オールインワン |

### 投資・株式

| アプリ | スター | 機能 |
|--------|--------|------|
| My Stocks | 45 | 株式追跡、複数API対応 |
| SIP Calculator | 37 | 投資計算 |
| Cryptocurrency Info | 7 | 暗号価格表示 |

---

## セキュリティパターン

### ウォレットセキュリティ

```swift
// 秘密鍵管理パターン
class KeychainManager {
    func storePrivateKey(_ key: Data, for address: String) throws {
        let query: [String: Any] = [
            kSecClass as String: kSecClassGenericPassword,
            kSecAttrAccount as String: address,
            kSecValueData as String: key,
            kSecAttrAccessible as String: kSecAttrAccessibleWhenUnlockedThisDeviceOnly
        ]
        let status = SecItemAdd(query as CFDictionary, nil)
        guard status == errSecSuccess else {
            throw KeychainError.storeFailed
        }
    }
}
```

### 生体認証

```swift
import LocalAuthentication

func authenticateUser() async throws -> Bool {
    let context = LAContext()
    var error: NSError?

    guard context.canEvaluatePolicy(.deviceOwnerAuthenticationWithBiometrics, error: &error) else {
        throw AuthError.biometricsUnavailable
    }

    return try await context.evaluatePolicy(
        .deviceOwnerAuthenticationWithBiometrics,
        localizedReason: "ウォレットにアクセス"
    )
}
```

### トランザクション署名

```swift
// 典型的な署名フロー
struct TransactionSigner {
    func sign(transaction: Transaction, with privateKey: PrivateKey) throws -> SignedTransaction {
        let messageHash = transaction.hash()
        let signature = try privateKey.sign(messageHash)
        return SignedTransaction(transaction: transaction, signature: signature)
    }
}
```

---

## UI/UXパターン

### ダッシュボード

**共通要素**:
- 残高表示（大きく、中央）
- 最近の取引リスト
- 送金/受取ボタン
- ポートフォリオ割合

### 取引履歴

```swift
// 典型的な表示パターン
struct TransactionRow: View {
    let transaction: Transaction

    var body: some View {
        HStack {
            Image(systemName: transaction.isIncoming ? "arrow.down.left" : "arrow.up.right")
                .foregroundColor(transaction.isIncoming ? .green : .red)

            VStack(alignment: .leading) {
                Text(transaction.address.truncated)
                Text(transaction.date.formatted())
                    .font(.caption)
                    .foregroundColor(.secondary)
            }

            Spacer()

            Text(transaction.amount.formatted())
                .foregroundColor(transaction.isIncoming ? .green : .primary)
        }
    }
}
```

### 金額入力

**ベストプラクティス**:
- 大きな数字表示
- 通貨切り替え
- 最大ボタン
- 手数料表示
- 確認画面

---

## 暗号化・セキュリティ

### 階層的決定論的（HD）ウォレット

```swift
// BIP39/BIP44実装パターン
class HDWallet {
    let mnemonic: [String]
    private let masterKey: ExtendedKey

    init(entropy: Data) throws {
        self.mnemonic = try Mnemonic.generate(from: entropy)
        let seed = try Mnemonic.toSeed(mnemonic)
        self.masterKey = try ExtendedKey.master(seed: seed)
    }

    func deriveKey(path: DerivationPath) throws -> PrivateKey {
        return try masterKey.derive(path: path).privateKey
    }
}
```

### 安全なストレージ

| データ | 保存場所 | 暗号化 |
|--------|----------|--------|
| 秘密鍵 | Keychain | AES-256 |
| ニーモニック | Keychain | AES-256 |
| 取引履歴 | Core Data | SQLCipher |
| 設定 | UserDefaults | なし |

---

## データ層パターン

### ブロックチェーンAPI

```swift
// 典型的なAPIクライアント
protocol BlockchainAPI {
    func getBalance(address: String) async throws -> Balance
    func getTransactions(address: String) async throws -> [Transaction]
    func broadcastTransaction(_ signedTx: SignedTransaction) async throws -> TxHash
    func getGasPrice() async throws -> GasPrice
}

class EthereumAPI: BlockchainAPI {
    private let rpcURL: URL

    func getBalance(address: String) async throws -> Balance {
        let request = JSONRPCRequest(method: "eth_getBalance", params: [address, "latest"])
        return try await send(request)
    }
}
```

### 価格取得

```swift
// 価格フィード
class PriceService {
    func getCurrentPrice(for symbol: String) async throws -> Decimal {
        let url = URL(string: "https://api.coingecko.com/api/v3/simple/price?ids=\(symbol)&vs_currencies=usd")!
        let (data, _) = try await URLSession.shared.data(from: url)
        let response = try JSONDecoder().decode(PriceResponse.self, from: data)
        return response.price
    }
}
```

---

## Swiftパッケージ機会

### CryptoWalletKit

**機能**:
- HD ウォレット生成
- マルチチェーン対応
- トランザクション構築
- 署名ヘルパー

### SecureStorageKit

**機能**:
- Keychain抽象化
- 生体認証統合
- セキュアエンクレーブ
- 暗号化ヘルパー

### FinanceUIKit

**機能**:
- 金額表示コンポーネント
- 通貨フォーマッター
- チャートビュー
- 取引リスト

### BlockchainAPIClient

**機能**:
- Ethereum/Bitcoin対応
- WebSocket購読
- トランザクション追跡
- ガス見積もり

---

## 学習リソース

| アプリ | 学習ポイント |
|--------|-------------|
| Dime | Apple HIG準拠UI |
| Unstoppable | 分散型ウォレット設計 |
| Bither | セキュリティ実装 |
| lil wallet | SwiftUI + Web3 |
| AlphaWallet | NFT対応 |

---

## 開発上の注意点

### セキュリティ

| 項目 | 対策 |
|------|------|
| 秘密鍵 | デバイス外に出さない |
| ニーモニック | 画面コピー防止 |
| 通信 | HTTPS + 証明書ピニング |
| ログ | 機密情報除外 |
| デバッグ | 本番ビルドで無効化 |

### コンプライアンス

| 地域 | 規制 |
|------|------|
| 米国 | 暗号通貨規制、KYC |
| EU | MiCA規制 |
| 日本 | 資金決済法 |

### テスト

| 種類 | 対象 |
|------|------|
| Unit | 暗号化、署名 |
| Integration | API通信 |
| Security | ペネトレーション |
| Testnet | 実際のトランザクション |

---

## トレンド

### 成長中
- DeFi統合
- NFTサポート
- マルチチェーン
- SwiftUI採用

### 安定
- Bitcoin/Ethereumウォレット
- 家計簿アプリ

### 注目
- Apple Pay暗号通貨
- Lightning Network
- Layer 2ソリューション
